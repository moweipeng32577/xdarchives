<?xml version="1.0" encoding="UTF-8"?><ureport><cell expand="None" name="A1" row="1" col="1"><cell-style font-size="10" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="B1" row="1" col="2" col-span="5"><cell-style font-size="18" font-family="宋体" bold="true" align="center" valign="middle"></cell-style><simple-value><![CDATA[档案入库统计表]]></simple-value></cell><cell expand="None" name="G1" row="1" col="7"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="A2" row="2" col="1"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="B2" row="2" col="2"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="C2" row="2" col="3"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="D2" row="2" col="4"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="E2" row="2" col="5"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="F2" row="2" col="6"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="G2" row="2" col="7"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="A3" row="3" col="1"><cell-style font-size="10" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="B3" row="3" col="2" col-span="4"><cell-style font-size="11" bold="true" align="center" valign="middle"><left-border width="1" style="solid" color="0,0,0"/><right-border width="1" style="solid" color="0,0,0"/><top-border width="1" style="solid" color="0,0,0"/><bottom-border width="1" style="solid" color="0,0,0"/></cell-style><simple-value><![CDATA[分类]]></simple-value></cell><cell expand="None" name="F3" row="3" col="6"><cell-style font-size="11" bold="true" align="center" valign="middle"><left-border width="1" style="solid" color="0,0,0"/><right-border width="1" style="solid" color="0,0,0"/><top-border width="1" style="solid" color="0,0,0"/><bottom-border width="1" style="solid" color="0,0,0"/></cell-style><simple-value><![CDATA[总数]]></simple-value></cell><cell expand="None" name="G3" row="3" col="7"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="None" name="A4" row="4" col="1"><cell-style font-size="10" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><cell expand="Down" name="B4" row="4" col="2"><cell-style font-size="10" align="center" valign="middle"><left-border width="1" style="solid" color="0,0,0"/><right-border width="1" style="solid" color="0,0,0"/><top-border width="1" style="solid" color="0,0,0"/><bottom-border width="1" style="solid" color="0,0,0"/></cell-style><dataset-value dataset-name="tj" aggregate="group" property="classname1" order="none" mapping-type="simple"></dataset-value></cell><cell expand="Down" name="C4" row="4" col="3"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"><left-border width="1" style="solid" color="0,0,0"/><right-border width="1" style="solid" color="0,0,0"/><top-border width="1" style="solid" color="0,0,0"/><bottom-border width="1" style="solid" color="0,0,0"/></cell-style><dataset-value dataset-name="tj" aggregate="group" property="classname2" order="none" mapping-type="simple"></dataset-value></cell><cell expand="Down" name="D4" row="4" col="4"><cell-style font-size="10" align="center" valign="middle"><left-border width="1" style="solid" color="0,0,0"/><right-border width="1" style="solid" color="0,0,0"/><top-border width="1" style="solid" color="0,0,0"/><bottom-border width="1" style="solid" color="0,0,0"/></cell-style><dataset-value dataset-name="tj" aggregate="group" property="classname3" order="none" mapping-type="simple"></dataset-value></cell><cell expand="Down" name="E4" row="4" col="5"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"><left-border width="1" style="solid" color="0,0,0"/><right-border width="1" style="solid" color="0,0,0"/><top-border width="1" style="solid" color="0,0,0"/><bottom-border width="1" style="solid" color="0,0,0"/></cell-style><dataset-value dataset-name="tj" aggregate="group" property="classname4" order="none" mapping-type="simple"></dataset-value></cell><cell expand="None" name="F4" row="4" col="6"><cell-style font-size="10" align="center" valign="middle"><left-border width="1" style="solid" color="0,0,0"/><right-border width="1" style="solid" color="0,0,0"/><top-border width="1" style="solid" color="0,0,0"/><bottom-border width="1" style="solid" color="0,0,0"/></cell-style><dataset-value dataset-name="tj" aggregate="count" property="entryid" order="none" mapping-type="simple"><condition property="entryid" op="!=" id="undefined" type="property"><value><![CDATA[NULL]]></value></condition></dataset-value></cell><cell expand="None" name="G4" row="4" col="7"><cell-style font-size="9" forecolor="0,0,0" font-family="宋体" align="center" valign="middle"></cell-style><simple-value><![CDATA[]]></simple-value></cell><row row-number="1" height="34" band="headerrepeat"/><row row-number="2" height="10" band="headerrepeat"/><row row-number="3" height="18" band="headerrepeat"/><row row-number="4" height="18"/><column col-number="1" width="80"/><column col-number="2" width="80"/><column col-number="3" width="74"/><column col-number="4" width="80"/><column col-number="5" width="74"/><column col-number="6" width="80"/><column col-number="7" width="74"/><datasource name="NeoUnit" type="buildin"><dataset name="tj" type="sql"><sql><![CDATA[${
  var sql = "select * from (select top 100 percent cl1.classid classid1,cl1.classname classname1, cl2.classid classid2,cl2.classname classname2,cl3.classid classid3,cl3.classname classname3,cl4.classid classid4,cl4.classname classname4 from (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence ) cl1 left join (select top 100 percent cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl1.classid = cl2.parentclassid left join (select top 100 percent cl3.classid,cl3.classname,cl3. parentclassid from tb_classification cl3 right join (select top 100 percent cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\')order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl3.parentclassid = cl2.classid) cl3 on cl2.classid = cl3.parentclassid left join (select top 100 percent cl4.classid,cl4.classname,cl4. parentclassid from tb_classification cl4 right join (select top 100 percent cl3.classid,cl3.classname,cl3. parentclassid from tb_classification cl3 right join (select top 100 percent cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT  top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl3.parentclassid = cl2.classid) cl3 on cl4.parentclassid = cl3.classid) cl4 on cl3.classid = cl4.parentclassid order by cl1.classname ) t    left join   (select top 100 percent entryid,classid from (SELECT top 100 percent si.waretime,si.waretype,st.stid,st.entry,st.storestatus FROM st_inware_storages ist left join st_inware si on ist.inwares_inid = si.inid left join st_storage st on ist.storages_stid = st.stid where storestatus = \'已入库\') sto inner join tb_entry_index tei on sto.entry = tei.entryid inner join tb_data_node tdn on tdn.nodeid = tei.nodeid) e  on t.classid1 = e.classid or t.classid2 = e.classid or t.classid3 = e.classid or t.classid4 = e.classid ";
  var dateParams = "";
  var classifyIds = "";
  if(param("starttime") != null){
  	dateParams = dateParams + " and si.waretime >= :starttime";
  }
  if(param("endtime") != null){
  	dateParams = dateParams + " and si.waretime <= :endtime";
  }
  if(param("classifyId") != null){
  	classifyIds = " where  classid1 in (\'" + replace(param("classifyId"),",","\',\'") + "\') or classid2 in (\'" + replace(param("classifyId"),",","\',\'") + "\') or classid3 in (\'" + replace(param("classifyId"),",","\',\'") + "\') or classid4 in (\'" + replace(param("classifyId"),",","\',\'") + "\') ";
  }
  if(dateParams != ""){
   	sql = "select * from (select top 100 percent cl1.classid classid1,cl1.classname classname1, cl2.classid classid2,cl2.classname classname2,cl3.classid classid3,cl3.classname classname3,cl4.classid classid4,cl4.classname classname4 from (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence ) cl1 left join (select top 100 percent  cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl1.classid = cl2.parentclassid left join (select top 100 percent cl3.classid,cl3.classname,cl3. parentclassid from tb_classification cl3 right join (select top 100 percent cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\')order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl3.parentclassid = cl2.classid) cl3 on cl2.classid = cl3.parentclassid left join (select top 100 percent cl4.classid,cl4.classname,cl4. parentclassid from tb_classification cl4 right join (select top 100 percent cl3.classid,cl3.classname,cl3. parentclassid from tb_classification cl3 right join (select cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl3.parentclassid = cl2.classid) cl3 on cl4.parentclassid = cl3.classid) cl4 on cl3.classid = cl4.parentclassid order by cl1.classname ) t    left join   (select top 100 percent entryid,classid from (SELECT top 100 percent si.waretime,si.waretype,st.stid,st.entry,st.storestatus FROM st_inware_storages ist left join st_inware si on ist.inwares_inid = si.inid left join st_storage st on ist.storages_stid = st.stid where storestatus = \'已入库\'"+dateParams+") sto inner join tb_entry_index tei on sto.entry = tei.entryid inner join tb_data_node tdn on tdn.nodeid = tei.nodeid) e  on t.classid1 = e.classid or t.classid2 = e.classid or t.classid3 = e.classid or t.classid4 = e.classid "+classifyIds+""
  }else {
  	sql = "select * from (select top 100 percent cl1.classid classid1,cl1.classname classname1, cl2.classid classid2,cl2.classname classname2,cl3.classid classid3,cl3.classname classname3,cl4.classid classid4,cl4.classname classname4 from (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence ) cl1 left join (select top 100 percent cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl1.classid = cl2.parentclassid left join (select top 100 percent cl3.classid,cl3.classname,cl3. parentclassid from tb_classification cl3 right join (select top 100 percent cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\')order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl3.parentclassid = cl2.classid) cl3 on cl2.classid = cl3.parentclassid left join (select top 100 percent cl4.classid,cl4.classname,cl4. parentclassid from tb_classification cl4 right join (select top 100 percent cl3.classid,cl3.classname,cl3. parentclassid from tb_classification cl3 right join (select top 100 percent cl2.classid,cl2.classname,cl2. parentclassid from tb_classification cl2 right join (SELECT top 100 percent * FROM tb_classification cl1 where parentclassid is null or parentclassid = \'\' and classname not in (\'全宗卷管理\',\'编研采集\') order by sortsequence) cl1 on cl2.parentclassid = cl1.classid) cl2 on cl3.parentclassid = cl2.classid) cl3 on cl4.parentclassid = cl3.classid) cl4 on cl3.classid = cl4.parentclassid order by cl1.classname ) t    left join   (select top 100 percent entryid,classid from (SELECT top 100 percent si.waretime,si.waretype,st.stid,st.entry,st.storestatus FROM st_inware_storages ist left join st_inware si on ist.inwares_inid = si.inid left join st_storage st on ist.storages_stid = st.stid where storestatus = \'已入库\') sto inner join tb_entry_index tei on sto.entry = tei.entryid inner join tb_data_node tdn on tdn.nodeid = tei.nodeid) e  on t.classid1 = e.classid or t.classid2 = e.classid or t.classid3 = e.classid or t.classid4 = e.classid "+classifyIds+""
  }

  return sql;
}]]></sql><field name="classid1"/><field name="classname1"/><field name="classid2"/><field name="classname2"/><field name="classid3"/><field name="classname3"/><field name="classid4"/><field name="classname4"/><field name="entryid"/><field name="classid"/><parameter name="starttime" type="String" default-value=""/><parameter name="endtime" type="String" default-value=""/><parameter name="classifyId" type="String" default-value=""/></dataset></datasource><paper type="A4" left-margin="28" right-margin="28" top-margin="28" bottom-margin="28" paging-mode="fitpage" fixrows="0" width="595" height="842" orientation="portrait" html-report-align="center" bg-image="" html-interval-refresh-value="0" column-enabled="false"></paper></ureport>
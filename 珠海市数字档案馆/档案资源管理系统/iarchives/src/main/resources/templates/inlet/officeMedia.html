<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <title>office文档查看</title>
<meta content="IE=7" http-equiv="X-UA-Compatible" /> 
		<!--设置缓存-->
		<meta http-equiv="cache-control" content="no-cache,must-revalidate">
		<meta http-equiv="pragram" content="no-cache">
		<meta http-equiv="expires" content="0">
    <link href="../../ntko/StyleSheet.css" rel="stylesheet" type="text/css" />
	<style>
		html,body,form{
			width:100%;
			height: 100%;
		}
	</style>
   <script type="text/javascript" src="../../ntko/OfficeContorlFunctions.js"></script>
   <script th:inline="javascript">
    var isJy = [[${isJy}]];
    var filesrc = [[${imgsrc}]];
    var filetype = [[${filetype}]];
	window.onload=function(){
		intializePage(filesrc);
	} 

</script>
</head>
<body onbeforeunload ="onPageClose()">
    <form id="form1" action="" enctype="multipart/form-data" style="padding:0px;margin:0px;">
                <object id="TANGER_OCX" classid="clsid:A39F1330-3322-4a1d-9BF0-0BA2BB90E970" codebase="../../ntko/OfficeControl.cab#version=5,0,3,1" width="100%" height="100%">
					<param name="IsUseUTF8URL" value="-1">
					<param name="IsUseUTF8Data" value="-1">
					<param name="BorderStyle" value="1">
					<param name="BorderColor" value="14402205">
					<param name="TitlebarColor" value="15658734">
					<param name="TitlebarTextColor" value="0">
					<param name="MenubarColor" value="14402205">
					<param name="MenuButtonColor" value="16180947">
					<param name="MenuBarStyle" value="3">
					<param name="MenuButtonStyle" value="7">
					<param name="WebUserName" value="NTKO"> 
					<param name="Caption" value="office查看">
					<span style="color:red">加载失败，请先安装文件的查看控件，才可在IE内核浏览器中在线预览。<a th:href="${imgsrc}">下载（电子文件到本地查看）</a></span>
				</object>
				<script language="JScript" for=TANGER_OCX event="OnDocumentClosed()">
					setFileOpenedOrClosed(false);
				</script>
				<script language="JScript" for="TANGER_OCX" event="OnDocumentOpened(TANGER_OCX_str,TANGER_OCX_obj)">
					OFFICE_CONTROL_OBJ.activeDocument.saved=true;//saved属性用来判断文档是否被修改过,文档打开的时候设置成ture,当文档被修改,自动被设置为false,该属性由office提供.
					OFFICE_CONTROL_OBJ.fileprint=false;//是否允许打印
					OFFICE_CONTROL_OBJ.FileNew=false;//是否允许新建
					OFFICE_CONTROL_OBJ.FileSave=false;//是否允许另存为
					OFFICE_CONTROL_OBJ.FileSaveAs=false;//是否允许另存为
                    OFFICE_CONTROL_OBJ.Menubar=false;//是否显示菜单栏
                    OFFICE_CONTROL_OBJ.ToolBars=false;
					//OFFICE_CONTROL_OBJ.IsNoCopy=false;//是否禁止粘贴(会影响整个系统的复制粘贴)
					//获取文档控件中打开的文档的文档类型
					switch (OFFICE_CONTROL_OBJ.doctype)
					{
						case 1:
							fileType = "Word.Document";
							fileTypeSimple = "wrod";
							break;
						case 2:
							fileType = "Excel.Sheet";
							fileTypeSimple="excel";
							break;
						case 3:
							fileType = "PowerPoint.Show";
							fileTypeSimple = "ppt";
							break;
						case 4:
							fileType = "Visio.Drawing";
							break;
						case 5:
							fileType = "MSProject.Project";
							break;
						case 6:
							fileType = "WPS Doc";
							fileTypeSimple="wps";
							break;
						case 7:
							fileType = "Kingsoft Sheet";
							fileTypeSimple="et";
							break;
						default :
							fileType = "unkownfiletype";
							fileTypeSimple="unkownfiletype";
					}
					setFileOpenedOrClosed(true);
				</script>
				<script language="JScript" for=TANGER_OCX event="BeforeOriginalMenuCommand(TANGER_OCX_str,TANGER_OCX_obj)"></script>
    </form>
</body>
</html>